<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<head>

<title>Analyseur de textes</title>
</head>
<body>
<h1>Analyseur de textes</h1>
<p><a href="https://github.com/Sweeney97/Sweeney97.github.io/blob/master/analyseur_textes.html">Code source de la page</a></p>
<br>
<p>Choisissez une couleur</p>
<select id="couleur">
   <option value="#BCC6CC" selected="selected">Métallique</option>
   <option value="#FFCBA4">Pêche</option>
   <option value="#FFFFC2">Parchemin</option>
   <option value="#FDEEF4">Perle</option>
</select>
<br>
<br>

<form action="javascript:compteur();">
<h2>Veuillez inscrire un texte (plusieurs phrases).</h2>
<p><textarea id="texte" rows="8" cols="60"></textarea></p>
<input type="button" value="Soumettre" onclick="SubmitFonc()">
</form>

<br>
<br>

<script  type='text/javascript'>

document.getElementById("texte");
texte.select();

var texte_utilisateur = null;
var y =0;
var max = 0;
var fmax = 0;
var min = 0;
var table = null;
var compteur = [];
var color_user = "#BCC6CC";

function SubmitFonc() {     // début de la fonction liée au bouton


if (document.getElementById("texte").value == "") {
    alert("Veuillez entrer un texte.");
    return;
    }

y =0;
max = 0;
fmax = 0;
min = 0;
table = null;
compteur = [];
texte_utilisateur = document.getElementById("texte").value;
texte_utilisateur = texte_utilisateur.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()«»]/g," ");
texte_utilisateur = texte_utilisateur.replace(/\n/g, " ");
texte_utilisateur = texte_utilisateur.replace(/\W/g, " ");

texte_utilisateur = texte_utilisateur.split(" ");                  // Transforme le texte en array
nbr = texte_utilisateur.length;

for  (y =0; y < nbr; y++) {
    texte_utilisateur[y] = texte_utilisateur[y].length;             // Remplace les mots par leur longueur
    }

min = Math.min.apply(null, texte_utilisateur);               // Stocke la valeur maximale et minimale
max = Math.max.apply(null, texte_utilisateur);

for  (y =0; y < max; y++) {                                           //Création du tableau comtpeur
    compteur.push(0);
    }

compteur.push(0);                                                      //Ajout d'une valeur, car la position 0 n'est pas utilisée


compteur_array();                                                    //Fonction qui compte le nombre de fréquence de longueur des mots
fmax = Math.max.apply(null, compteur);

compteur[0] = 0;

generate_header()

y = 1;                                                                      // Y est 1 pour ne pas afficher la première ligne du compteur (la valeur 0)
for (var i = 0; i < max; i++) {                                 // Boucle qui appelle la fonction qui crée dynamiquement le tableau
    var x = compteur[y];
    generate_table(x, y);
    y++;
    }

document.getElementById("nbrmots");
nbrmots.innerText = nbr  + " mots dans le texte.";

document.getElementById("texte");
texte.select();

                                        }                                   // fin de la fonction principale liée au bouton

function compteur_array()  {
  while (y < nbr) {
    let z = texte_utilisateur[y];
    compteur[z]+= 1;
    y++;                  }
    y = 0;
                                            }

function generate_table(x,y) {
  color_user = document.getElementById("couleur").value;
  var frn = ((x/fmax)*1000)/3;
  var body = document.getElementsByTagName("body")[0];
  var tbl = document.createElement("table");
  var tblBody = document.createElement("tbody");
  var row = document.createElement("tr");

  var cell = document.createElement("td");
  cell.style.width = "333.333px";
  var cellText = document.createTextNode(""+y+"");
  cell.appendChild(cellText);
  row.appendChild(cell);

  var cell = document.createElement("td");
  cell.style.width = "333.333px";
  var cellText = document.createTextNode(""+x+"");
  cell.appendChild(cellText);
  row.appendChild(cell);

  var cell= document.createElement("td");
  cell.style.width = frn + "px";
  cell.style.background = color_user;
  row.appendChild(cell);

  tblBody.appendChild(row);

  tbl.appendChild(tblBody);
  body.appendChild(tbl);
  tbl.setAttribute("border", "2");
  }

function generate_header() {
  var body = document.getElementsByTagName("body")[0];
  var tbl = document.createElement("table");
  var tblBody = document.createElement("tbody");
  var row = document.createElement("tr");
  var cell = document.createElement("td");
  cell.style.width = "333.333px";
  var cellText = document.createTextNode("Nombre de lettres");
  cell.appendChild(cellText);
  row.appendChild(cell);

  var cell = document.createElement("td");
  cell.style.width = "333.333px";
  var cellText = document.createTextNode("Fréquence");
  cell.appendChild(cellText);
  row.appendChild(cell);

  var cell = document.createElement("td");
  cell.style.width = "333.333px";
  var cellText = document.createTextNode("Fréquence normative relativisée");
  cell.appendChild(cellText);
  row.appendChild(cell);

  tblBody.appendChild(row);

  tbl.appendChild(tblBody);
  body.appendChild(tbl);
  tbl.setAttribute("border", "2");
  }

</script>

<p id= nbrmots></p>

</body>
</html>
